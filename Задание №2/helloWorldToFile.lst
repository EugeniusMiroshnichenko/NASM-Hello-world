     1                                  section .text
     2                                  
     3                                  global _start
     4                                  
     5                                  _start:
     6                                  
     7                                      ; Открытие файла
     8                                  
     9 00000000 B802000000                  mov rax, 0x2  ; sys_open
    10                                      ; Проверяем наличие файла, если его нет, созадаём + открываем только на чтение + очищаем файл при открытии
    11 00000005 48BF-                       mov rdi, fileName
    11 00000007 [0000000000000000] 
    12 0000000F BE41020000                  mov rsi, 0x241 ; O_WRONLY = 0x0001  O_CREAT = 0x0040  O_TRUNC  = 0x0200
    13 00000014 BAA4010000                  mov rdx, 0644o ; админу чтение и запись, остальным чтение
    14 00000019 0F05                        syscall
    15                                      
    16                                      ; После успешного выполнения rax хранит или дескриптор файла
    17                                      ; в случае неуспешного открытия содержит отрицательное число
    18 0000001B 4883F800                    cmp rax, 0
    19 0000001F 7C3E                        JL errorSection
    20                                  
    21                                  
    22                                      ; Запись в файл
    23                                  
    24 00000021 4989C2                      mov r10, rax ; Запоминаем дескриптор
    25 00000024 B801000000                  mov rax, 0x1
    26 00000029 4C89D7                      mov rdi, r10
    27 0000002C 48BE-                       mov rsi, msg
    27 0000002E [0700000000000000] 
    28 00000036 BA0E000000                  mov rdx, len
    29 0000003B 0F05                        syscall
    30                                      
    31 0000003D 4883F80E                    cmp rax, len ; rax не меняется, код ошибки не теряем, если она есть
    32 00000041 7C1C                        jl errorSection ; % Записано меньше символов, чем ожидалось (если есть ошибка, то результат автоматически будет отрицательным)
    33                                  
    34                                  
    35                                      ; Закрытие файла
    36                                  
    37 00000043 B803000000                  mov rax, 0x3
    38 00000048 4C89D7                      mov rdi, r10
    39 0000004B 0F05                        syscall
    40                                      
    41                                      ; В случае неуспешного закрытия содержит отрицательное число
    42 0000004D 4883F800                    cmp rax, 0
    43 00000051 7C0C                        JL errorSection
    44                                      
    45                                      
    46                                      ; Завершение
    47                                  
    48 00000053 B83C000000                  mov rax, 0x3c
    49 00000058 BF00000000                  mov rdi, 0x0
    50 0000005D 0F05                        syscall
    51                                  
    52                                  
    53                                  errorSection:
    54                                      ; Вывелись не все символы на экран или есть ошибка
    55                                      ; Код ошибки лежим в rax, здесь возможна какая-то дополнительная логика
    56 0000005F B801000000                  mov rax, 0x1
    57 00000064 BF02000000                  mov rdi, 0x2
    58 00000069 48BE-                       mov rsi, erMsg
    58 0000006B [1500000000000000] 
    59 00000073 BA1B000000                  mov rdx, erMsgLen
    60 00000078 0F05                        syscall
    61                                      
    62 0000007A B83C000000                  mov rax, 0x3c
    63 0000007F BF01000000                  mov rdi, 0x1
    64 00000084 0F05                        syscall
    65                                      
    66                                  
    67                                  section .data
    68 00000000 6F757470757400              fileName db "output", 0
    69 00000007 48656C6C6F20776F72-         msg db  "Hello world!", "\n"
    69 00000010 6C64215C6E         
    70                                      len equ $ - msg
    71 00000015 4572726F7220686170-         erMsg db "Error happed during work!", "\n"
    71 0000001E 70656420647572696E-
    71 00000027 6720776F726B215C6E 
    72                                      erMsgLen equ $ - erMsg
